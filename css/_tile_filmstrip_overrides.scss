/**
 * Override other styles to support tile filmstrip mode.
 */



.tile-filmstrip {
    /*
     * Firefox sets flex items to min-height: auto and min-width: auto,
     * preventing flex children from shrinking like they do on other browsers.
     * Setting min-height and min-width 0 is a workaround for the issue so
     * Firefox behaves like other browsers.
     * https://bugzilla.mozilla.org/show_bug.cgi?id=1043520
     */
    @mixin minHWAutoFix() {
        //todo: fixme
        min-height: 0;
        min-width: 0;
    }

    #etherpad,
    #sharedvideo {
        //todo: fixme
        text-align: left;
    }

    &.use-new-toolbox {
        /**
         * Adjust the height of the filmstrip as the toolbar is displayed.

           todo: REMEMBER TO UPDATE THIS AFTER CHANGES TO TOOLBAR HAVE BEEN MADE

         */
        .filmstrip {

            /** serves as the wrapper div for the remoteVideos */

            all: unset;

        }

    }

    .filmstrip {

        &.reduce-height {
            bottom: 0;
        }

        /**
         * fixed positioning is necessary for remote menus and tooltips to pop
         * out of the scrolling filmstrip. AtlasKit dialogs and tooltips use
         * a library called popper which will position its elements fixed if
         * any parent is also fixed.
         */

        /**
         * Hide videos by making them slight to the right.
         */
        .filmstrip__videos {

            bottom: 0;

            &.hidden {
                /** No longer hiding videoContainers, settings bottom to 0 will ensure*/
                all: unset;
            }

            /**
             * An id selector is used to match id specificity with existing
             * filmstrip styles.
             */
            &#remoteVideos {

            /**
             * No longer need padding-left as we can use grid properties to create spacing.
             */

            }

            &#filmstripRemoteVideos {
                all: unset;
            }
        }

        /**
         * Remove unnecssary padding that is normally used to prevent horizontal
         * filmstrip from overlapping the left edge of the screen.
         */
        #filmstripLocalVideo,
        #filmstripRemoteVideos {
            padding: 0;
            // todo ask: do I even need this if I have removed all the flex props? It still shows a flex prop in the dom.
            align-self: unset;
        }

        #filmstripRemoteVideos {

            @include minHWAutoFix();


        }

        /**
         * dont show toolbar for tile view
         */
        &__toolbar {

            display: none;
        }

        //todo: rethink video menu trigger

        /**
         * Move the remote video menu trigger to the bottom left of the
         * video thumbnail.
         */
        .remotevideomenu,
        .remote-video-menu-trigger {
            bottom: 0;
            left: 0;
            top: auto;
            right: auto;
        }

        .remote-video-menu-trigger {
            margin-bottom: 7px;
        }

        #remoteVideos {
            all: unset;
        }

        .videocontainer {

            /**
             * Move status icons to the bottom right of the thumbnail.
             */
            &__toolbar {
                text-align: right;

                .right {
                    float: none;
                    margin: auto;
                }
            }
        }


    }

    /** local videocontainer will be appended to remote, as such unset all values */

    /** Grid Container todo: rename the container? */

    #gridViewContainer {

        display: grid;
        width: 100%;
        height: 100%;
        grid-gap: 2px;
        padding: 0;
        margin: 0;

        .videocontainer {
            // represents a tile ( cell )
            position: relative;
            grid-row: span 1;
            grid-column: span 1;
        }

        #localVideoContainer {

            all: unset;

        }


    }



    #filmstripRemoteVideosContainer {
        all: unset;
        display: none;
    }

    /** various remote-video containers */
    .remote-videos-container {

        .videocontainer {

            // Unset props
            display: block !important;
            height: unset !important;
            width: unset !important;
            min-height: unset !important;
            min-width: unset !important;
            grid-row: span 1;
            grid-column: span 1;
        }


    }


    &.filmstrip-only {
        .filmstrip {
            //flex-direction: row-reverse;
        }
        .filmstrip__videos-filmstripOnly {
            height: 100%;
        }
    }

    /**
     * These styles are for the video labels that display on the top right. The
     * styles adjust the labels' positioning as the filmstrip itself or
     * filmstrip's remote videos appear and disappear.
     *
     * The class with-filmstrip is for when the filmstrip is visible.
     * The class without-filmstrip is for when the filmstrip has been toggled to
     * be hidden.
     * The class opening is for when the filmstrip is transitioning from hidden
     * to visible.
     */
    .large-video-labels {
        &.with-filmstrip {
            right: 150px;
        }

        &.with-filmstrip.opening {
            transition: 0.9s;
            transition-timing-function: ease-in-out;
        }

        &.without-filmstrip {
            transition: 1.2s ease-in-out;
            transition-delay: 0.1s;
        }
    }

    /**
     * Apply hardware acceleration to prevent flickering on scroll. The
     * selectors are specific to icon wrappers to prevent fixed position dialogs
     * and tooltips from getting a new location context due to translate3d.
     */
    .connection-indicator,
    .remote-video-menu-trigger,
    .indicator-icon-container {
        transform: translate3d(0, 0, 0);
    }

    .indicator-container {
        float: none;
    }

    /**
     * FIXME: disable pointer to allow any elements moved below to still be
     * clickable. The real fix would to make sure those moved elements are
     * actually part of the toolbar instead of positioning being faked.
     */
    .videocontainer__toolbar {
        pointer-events: none;

        > div {
            pointer-events: none;
        }

        .toolbar-icon {
            pointer-events: all;
        }
    }
}

/**
 * Workarounds for Edge, IE11, and Firefox not handling scrolling properly
 * with flex-direction: column-reverse. The remove videos in filmstrip should
 * start scrolling from the bottom of the filmstrip, but in those browsers the
 * scrolling won't happen. Per W3C spec, scrolling should happen from the
 * bottom. As such, use css hacks to get around the css issue, with the intent
 * being to remove the hacks as the spec is supported.
 */
@mixin undoColumnReverseVideos() {
    .vertical-filmstrip {
        #remoteVideos #filmstripRemoteVideos #filmstripRemoteVideosContainer {
            flex-direction: unset;
        }
    }
}


/** Firefox detection hack **/
@-moz-document url-prefix() {
    @include undoColumnReverseVideos();
}

/** IE11 detection hack **/
@media screen and (-ms-high-contrast: active),
screen and (-ms-high-contrast: none) {
    @include undoColumnReverseVideos();
}

/** Edge detection hack **/
@supports (-ms-ime-align:auto) {
    @include undoColumnReverseVideos();
}
